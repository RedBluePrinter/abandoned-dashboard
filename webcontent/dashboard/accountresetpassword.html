<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400&display=swap" rel="stylesheet">
    <style>
        %stylesheet%
    </style>
</head>
<body>
<div class="loginbgdiv" action="javascript: reset()">
    <h1>Change Password</h1>
    <form action="/auth/resetpassword">
        <input name="type" type="hidden" value="login"/>
        <p>Email</p>
        <input name="username" type="text" class="field">
        <br>
        <p>Old Password</p>
        <input name="oldpassword" type="password" class="field">
        <br>
        <p>New Password</p>
        <input name="newpassword" type="password" class="field">
        <br>
        <input name="Change Password" type="submit" value="Confirm" class="button">
    </form>
</div>
<script>
        let stateObj = { id: "100" };
        window.history.replaceState(stateObj,
        "Dashboard", "/auth/resetpassword");
        async function reset() {
            var username = "";
            var oldpassword = "";
            var newpassword = "";
            var x = $("form").serializeArray();
                            $.each(x, function(i, field) {
                                if(field.name == "oldpassword") oldpassword = field.value;
                                if(field.name == "newpassword") newpassword = field.value;
                                if(field.name == "username") username = field.value;
                });
                alert(username);
            $.ajax({
  url:  "/auth/resetpassword?username=" + username + "&oldpassword=" + oldpassword + "&newpassword=" + newpassword
}).done(function(response) {
document.open();
document.write(response);
document.close();

            let stateObj = { id: "100" };
            window.history.replaceState(stateObj,
                        "Dashboard", "/auth/login");
});
        } 
</script>
</body>
</html>